define(["require","exports","./sectionbuilder"],function(n,t,i){"use strict";function l(n){var t=v(n),i,u,f;t>0&&t<r.content.length&&(i=$("#Content"+t),u=$("#Content"+(t-1)),i.after(u),i.attr("id","Content"+(t-1)),u.attr("id","Content"+t),f=r.content[t],r.content[t]=r.content[t-1],r.content[t-1]=f)}function a(n){var t=v(n),i,u,f;t>=0&&t<r.content.length-1&&(i=$("#Content"+t),u=$("#Content"+(t+1)),i.before(u),i.attr("id","Content"+(t+1)),u.attr("id","Content"+t),f=r.content[t],r.content[t]=r.content[t+1],r.content[t+1]=f)}function v(n){return parseInt(n.attr("id").match(/\d*$/)[0])}function u(n,t,i){var r=$(t),u=$(c),f;return r.attr("id","Content"+n),f=r.find(".edit"),f.hide(0),u.find(".edit-btn").click(function(){f.toggle()}),u.find(".up").click(function(){l(r)}),u.find(".down").click(function(){a(r)}),r.append(u),i.append(r),r}function y(n,i){var f=n.find("code").first(),r,u,e;return f.attr("class",i.type),f.html(b(i.text)),r=n.find(".text-edit"),r.text(i.text),u=n.find(".type-edit"),u.val(i.type),e=n.find(".save-btn"),e.click(function(){i.text=r.val().toString();i.type=u.val().toString();t.draw()}),n}function p(n,i){n.find("p").first().text(i.text).text(i.text);var r=n.find(".edit"),u=n.find(".save-btn");return r.text(i.text),u.click(function(){i.text=r.val().toString();t.draw()}),n}function w(n,i){var r,u;return n.find(".sample").first().html(i.text),r=n.find(".text-edit"),r.text(i.text),u=n.find(".save-btn"),u.click(function(){i.text=r.val().toString();t.draw()}),n}function f(n,i){var r=n.find("img").first(),u,f,e;return r.attr("src",i.path),r.attr("alt",i.alt),u=n.find(".alt-edit"),u.val(i.alt),f=n.find(".src-edit"),e=n.find(".save-btn"),e.click(function(){i.alt=u.val().toString();var n=f.prop("files")[0];i.path=window.URL.createObjectURL(n);r.attr("src",i.path);r.attr("alt",i.alt);t.draw()}),n}t.__esModule=!0;var e,o,s,h,c,r,b=function(n){return n=n.replace(/</g,"&lt;"),n.replace(/>/g,"&gt;")};t.create=function(n){var u,f,e,t;switch(n){case"text":u=new i.TextContent;u.text="text";r.content.push(u);break;case"code":f=new i.CodeContent;f.text="<p>code<\/p>";r.content.push(f);break;case"sample":e=new i.ExampleContent;e.text="<p>code example<\/p>";r.content.push(e);break;case"img":t=new i.ImageContent;t.path="file://D:/Pictures/Texturen/bee.jpg";t.alt="missing image!";r.content.push(t)}};t.init=function(n){var t,u,f,l;r=i.SectionBuilder.fromJS(n);t=new i.TextContent;e=$("."+t.constructor.name)[0].innerHTML;u=new i.CodeContent;o=$("."+u.constructor.name)[0].innerHTML;f=new i.ExampleContent;s=$("."+f.constructor.name)[0].innerHTML;l=new i.ImageContent;h=$("."+l.constructor.name)[0].innerHTML;c=$(".content-control")[0].innerHTML};t.up=l;t.down=a;t.draw=function(){var n=function(n){var a=$("#col"),r,l;for(a.length==0&&(a=$('<div class="col" id="col"><\/div>')),$("#container").append(a),r=0;r<n.length;r++){var t=n[r],c="Content"+r,v=$("#"+c);v.length==0?t instanceof i.ExampleContent?(l=u(r,s,a),w(l,t,c)):t instanceof i.CodeContent?(l=u(r,o,a),y(l,t,c)):t instanceof i.TextContent?(l=u(r,e,a),p(l,t,c)):t instanceof i.ImageContent&&(l=u(r,h,a),f(l,t,c)):t instanceof i.ExampleContent?w(v,t,c):t instanceof i.CodeContent?y(v,t,c):t instanceof i.TextContent?p(v,t,c):t instanceof i.ImageContent&&f(v,t,c)}};n(r.content)};f});